function emaillinks_subject(b,a){var d=emaillinks_config.subj.exec(b);d&&a.setAttribute("href",a.getAttribute("href")+"?subject="+d[1])} function _emaillinks_process(b){var a,d,e,c=emaillinks_config,f=b.childNodes[0],k=3==f.nodeType,l=1==f.nodeType&&"img"==f.tagName.toLowerCase(),h=null;k&&(h=f.nodeValue);l&&(h=f.getAttribute("alt"));if(h){var m=c.name?c.name.exec(h):null,g=c.addr?c.addr.exec(h):null;if(g){e=b.getAttribute("title");g=g[1];if(c.unobs)for(a=0;a<c.unobs.length;a++)d=c.unobs[a],g=g.replace(d.re,d.txt);a=m?m[1]:e?e:g;k&&(f.nodeValue=a);l&&f.setAttribute("alt",a);b.setAttribute("href","mailto:"+g);if(c.process)for(a=0;a< c.process.length;a++)c.process[a](h,b)}}}function _emaillinks_processAll(){var b=new RegExp("\\b"+(emaillinks_config.className?emaillinks_config.className:"email")+"\\b"),a,d,e=document.getElementsByTagName("a");for(a=0;a<e.length;a++)d=e[a],d.className&&b.test(d.className)&&!d.getAttribute("href")&&_emaillinks_process(d)} var emaillinks_config={className:"email",addr:/<([^>]*)>/,name:/"([^"]*)"/,subj:/with subject "([^"]*)"/,process:[emaillinks_subject],unobs:[{re:/\s+at\s+/ig,txt:"@"},{re:/\s+dot\s+/ig,txt:"."},{re:/\s+-at-\s+/ig,txt:"@"},{re:/\s+-dot-\s+/ig,txt:"."},{re:/\s+\(at\)\s+/ig,txt:"@"},{re:/\s+\(dot\)\s+/ig,txt:"."},{re:/[\.]?invalid$/i,txt:""},{re:/\s+/g,txt:""}]};addEvent(window,"load",_emaillinks_processAll,!1);function addEvent(b,a,d,e){var c=navigator.userAgent,c=-1!=c.indexOf("KHTML")&&-1==c.indexOf("Safari")&&b==window&&"load"==a;if(b.addEventListener&&!c)return b.addEventListener(a,d,e),!0;if(b.attachEvent)return b.attachEvent("on"+a,d);b.cb_events||(b.cb_events={},b.cb_ftemp=null);e=b.cb_events[a];e||(e=[],b.cb_events[a]=e);for(c=0;c<e.length&&e[c]!=d;)c++;c==e.length&&(e[c]=d,b["on"+a]=new Function("var ret=false,e=this.cb_events['"+a+"'];if(e){for(var i=0;i<e.length;i++){this.cb_ftemp=e[i];ret=this.cb_ftemp()||ret;}return ret;}")); return!0}function removeEvent(b,a,d,e){var c=navigator.userAgent,c=-1!=c.indexOf("KHTML")&&-1==c.indexOf("Safari")&&b==window&&"load"==a;if(b.removeEventListener&&!c)return b.removeEventListener(a,d,e),!0;if(b.detachEvent)return b.detachEvent("on"+a,d);e=!1;if(b.cb_events&&(b=b.cb_events[a])){for(c=a=0;c<b.length;c++)a!=c&&(b[a]=b[c]),b[a]==d?e=!0:a++;b.length=a}return e};